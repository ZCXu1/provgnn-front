{"remainingRequest":"E:\\provgnn-front\\node_modules\\babel-loader\\lib\\index.js!E:\\provgnn-front\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\provgnn-front\\src\\permission.js","dependencies":[{"path":"E:\\provgnn-front\\src\\permission.js","mtime":1656917097381},{"path":"E:\\provgnn-front\\babel.config.js","mtime":1656917083853},{"path":"E:\\provgnn-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656917086294},{"path":"E:\\provgnn-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1656917085438},{"path":"E:\\provgnn-front\\node_modules\\eslint-loader\\index.js","mtime":1656917089063}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRTovcHJvdmdubi1mcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkU6L3Byb3Znbm4tZnJvbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgcm91dGVyIGZyb20gJy4vcm91dGVyJzsKaW1wb3J0IHN0b3JlIGZyb20gJy4vc3RvcmUnOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsgLy8gcHJvZ3Jlc3MgYmFyCgppbXBvcnQgJ25wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzJzsgLy8gcHJvZ3Jlc3MgYmFyIHN0eWxlCgppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7IC8vIGdldCB0b2tlbiBmcm9tIGNvb2tpZQoKaW1wb3J0IGdldFBhZ2VUaXRsZSBmcm9tICdAL3V0aWxzL2dldC1wYWdlLXRpdGxlJzsKTlByb2dyZXNzLmNvbmZpZ3VyZSh7CiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOyAvLyBOUHJvZ3Jlc3MgQ29uZmlndXJhdGlvbgoKdmFyIHdoaXRlTGlzdCA9IFsnL2xvZ2luJywgJy9hdXRoLXJlZGlyZWN0J107IC8vIG5vIHJlZGlyZWN0IHdoaXRlbGlzdAoKcm91dGVyLmJlZm9yZUVhY2goIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodG8sIGZyb20sIG5leHQpIHsKICAgIHZhciBoYXNUb2tlbiwgcm9sZSwgYWNjZXNzUm91dGVzOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAvLyBzdGFydCBwcm9ncmVzcyBiYXIKICAgICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7IC8vIHNldCBwYWdlIHRpdGxlCgogICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsgLy8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHVzZXIgaGFzIGxvZ2dlZCBpbgogICAgICAgICAgICAvLyBjb25zdCBoYXNUb2tlbiA9IGdldFRva2VuKCkKICAgICAgICAgICAgLy8gaWYgKGhhc1Rva2VuKSB7CiAgICAgICAgICAgIC8vICAgaWYgKHRvLnBhdGggPT09ICcvbG9naW4nKSB7CiAgICAgICAgICAgIC8vICAgICAvLyBpZiBpcyBsb2dnZWQgaW4sIHJlZGlyZWN0IHRvIHRoZSBob21lIHBhZ2UKICAgICAgICAgICAgLy8gICAgIG5leHQoeyBwYXRoOiAnLycgfSkKICAgICAgICAgICAgLy8gICAgIE5Qcm9ncmVzcy5kb25lKCkKICAgICAgICAgICAgLy8gICB9IGVsc2UgewogICAgICAgICAgICAvLyAgICAgLy8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHVzZXIgaGFzIG9idGFpbmVkIGhpcyBwZXJtaXNzaW9uIHJvbGVzIHRocm91Z2ggZ2V0SW5mbwogICAgICAgICAgICAvLyAgICAgY29uc3QgaGFzUm9sZXMgPSBzdG9yZS5nZXR0ZXJzLnJvbGVzICYmIHN0b3JlLmdldHRlcnMucm9sZXMubGVuZ3RoID4gMAogICAgICAgICAgICAvLyAgICAgaWYgKGhhc1JvbGVzKSB7CiAgICAgICAgICAgIC8vICAgICAgIG5leHQoKQogICAgICAgICAgICAvLyAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gICAgICAgICAvLyBnZXQgdXNlciBpbmZvCiAgICAgICAgICAgIC8vICAgICAgICAgLy8gbm90ZTogcm9sZXMgbXVzdCBiZSBhIG9iamVjdCBhcnJheSEgc3VjaCBhczogWydhZG1pbiddIG9yICxbJ2RldmVsb3BlcicsJ2VkaXRvciddCiAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgeyByb2xlcyB9ID0gYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ3VzZXIvZ2V0SW5mbycpCiAgICAgICAgICAgIC8vICAgICAgICAgLy8gZ2VuZXJhdGUgYWNjZXNzaWJsZSByb3V0ZXMgbWFwIGJhc2VkIG9uIHJvbGVzCiAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgYWNjZXNzUm91dGVzID0gYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnLCByb2xlcykKICAgICAgICAgICAgLy8gICAgICAgICAvLyBkeW5hbWljYWxseSBhZGQgYWNjZXNzaWJsZSByb3V0ZXMKICAgICAgICAgICAgLy8gICAgICAgICByb3V0ZXIuYWRkUm91dGVzKGFjY2Vzc1JvdXRlcykKICAgICAgICAgICAgLy8gICAgICAgICAvLyBoYWNrIG1ldGhvZCB0byBlbnN1cmUgdGhhdCBhZGRSb3V0ZXMgaXMgY29tcGxldGUKICAgICAgICAgICAgLy8gICAgICAgICAvLyBzZXQgdGhlIHJlcGxhY2U6IHRydWUsIHNvIHRoZSBuYXZpZ2F0aW9uIHdpbGwgbm90IGxlYXZlIGEgaGlzdG9yeSByZWNvcmQKICAgICAgICAgICAgLy8gICAgICAgICBuZXh0KHsgLi4udG8sIHJlcGxhY2U6IHRydWUgfSkKICAgICAgICAgICAgLy8gICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgLy8gICAgICAgICAvLyByZW1vdmUgdG9rZW4gYW5kIGdvIHRvIGxvZ2luIHBhZ2UgdG8gcmUtbG9naW4KICAgICAgICAgICAgLy8gICAgICAgICBhd2FpdCBzdG9yZS5kaXNwYXRjaCgndXNlci9yZXNldFRva2VuJykKICAgICAgICAgICAgLy8gICAgICAgICBNZXNzYWdlLmVycm9yKGVycm9yIHx8ICdIYXMgRXJyb3InKQogICAgICAgICAgICAvLyAgICAgICAgIG5leHQoYC9sb2dpbj9yZWRpcmVjdD0ke3RvLnBhdGh9YCkKICAgICAgICAgICAgLy8gICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpCiAgICAgICAgICAgIC8vICAgICAgIH0KICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgLy8gICB9CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIC8vICAgLyogaGFzIG5vIHRva2VuKi8KICAgICAgICAgICAgLy8gICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgICAgICAgIC8vICAgICAvLyBpbiB0aGUgZnJlZSBsb2dpbiB3aGl0ZWxpc3QsIGdvIGRpcmVjdGx5CiAgICAgICAgICAgIC8vICAgICBuZXh0KCkKICAgICAgICAgICAgLy8gICB9IGVsc2UgewogICAgICAgICAgICAvLyAgICAgLy8gb3RoZXIgcGFnZXMgdGhhdCBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyBhcmUgcmVkaXJlY3RlZCB0byB0aGUgbG9naW4gcGFnZS4KICAgICAgICAgICAgLy8gICAgIG5leHQoYC9sb2dpbj9yZWRpcmVjdD0ke3RvLnBhdGh9YCkKICAgICAgICAgICAgLy8gICAgIE5Qcm9ncmVzcy5kb25lKCkKICAgICAgICAgICAgLy8gICB9CiAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgIGhhc1Rva2VuID0gJ2FkbWluLXRva2VuJzsKICAgICAgICAgICAgcm9sZSA9ICdhZG1pbic7CgogICAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnLCByb2xlKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGFjY2Vzc1JvdXRlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIC8vIGR5bmFtaWNhbGx5IGFkZCBhY2Nlc3NpYmxlIHJvdXRlcwogICAgICAgICAgICByb3V0ZXIuYWRkUm91dGVzKGFjY2Vzc1JvdXRlcyk7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","from","next","start","document","title","meta","hasToken","role","dispatch","accessRoutes","addRoutes","afterEach","done"],"sources":["E:/provgnn-front/src/permission.js"],"sourcesContent":["import router from './router'\r\nimport store from './store'\r\nimport { Message } from 'element-ui'\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nimport { getToken } from '@/utils/auth' // get token from cookie\r\nimport getPageTitle from '@/utils/get-page-title'\r\n\r\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\r\n\r\nconst whiteList = ['/login', '/auth-redirect'] // no redirect whitelist\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  // start progress bar\r\n  NProgress.start()\r\n\r\n  // set page title\r\n  document.title = getPageTitle(to.meta.title)\r\n\r\n  // determine whether the user has logged in\r\n  // const hasToken = getToken()\r\n\r\n  // if (hasToken) {\r\n  //   if (to.path === '/login') {\r\n  //     // if is logged in, redirect to the home page\r\n  //     next({ path: '/' })\r\n  //     NProgress.done()\r\n  //   } else {\r\n  //     // determine whether the user has obtained his permission roles through getInfo\r\n  //     const hasRoles = store.getters.roles && store.getters.roles.length > 0\r\n  //     if (hasRoles) {\r\n  //       next()\r\n  //     } else {\r\n  //       try {\r\n  //         // get user info\r\n  //         // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']\r\n  //         const { roles } = await store.dispatch('user/getInfo')\r\n\r\n  //         // generate accessible routes map based on roles\r\n  //         const accessRoutes = await store.dispatch('permission/generateRoutes', roles)\r\n\r\n  //         // dynamically add accessible routes\r\n  //         router.addRoutes(accessRoutes)\r\n\r\n  //         // hack method to ensure that addRoutes is complete\r\n  //         // set the replace: true, so the navigation will not leave a history record\r\n  //         next({ ...to, replace: true })\r\n  //       } catch (error) {\r\n  //         // remove token and go to login page to re-login\r\n  //         await store.dispatch('user/resetToken')\r\n  //         Message.error(error || 'Has Error')\r\n  //         next(`/login?redirect=${to.path}`)\r\n  //         NProgress.done()\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // } else {\r\n  //   /* has no token*/\r\n\r\n  //   if (whiteList.indexOf(to.path) !== -1) {\r\n  //     // in the free login whitelist, go directly\r\n  //     next()\r\n  //   } else {\r\n  //     // other pages that do not have permission to access are redirected to the login page.\r\n  //     next(`/login?redirect=${to.path}`)\r\n  //     NProgress.done()\r\n  //   }\r\n  // }\r\n  const hasToken = 'admin-token'\r\n  const role = 'admin'\r\n  if (hasToken) {\r\n    next()\r\n    const accessRoutes = await store.dispatch('permission/generateRoutes', role)\r\n    // dynamically add accessible routes\r\n    router.addRoutes(accessRoutes)\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  // finish progress bar\r\n  NProgress.done()\r\n})\r\n"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB,C,CAAkC;;AAClC,OAAO,yBAAP,C,CAAiC;;AACjC,SAASC,QAAT,QAAyB,cAAzB,C,CAAwC;;AACxC,OAAOC,YAAP,MAAyB,wBAAzB;AAEAF,SAAS,CAACG,SAAV,CAAoB;EAAEC,WAAW,EAAE;AAAf,CAApB,E,CAA4C;;AAE5C,IAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,gBAAX,CAAlB,C,CAA+C;;AAE/CR,MAAM,CAACS,UAAP;EAAA,sEAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;IAAA;IAAA;MAAA;QAAA;UAAA;YAChB;YACAT,SAAS,CAACU,KAAV,GAFgB,CAIhB;;YACAC,QAAQ,CAACC,KAAT,GAAiBV,YAAY,CAACK,EAAE,CAACM,IAAH,CAAQD,KAAT,CAA7B,CALgB,CAOhB;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YAEA;YACA;YAEA;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;;YACME,QAxDU,GAwDC,aAxDD;YAyDVC,IAzDU,GAyDH,OAzDG;;YAAA,KA0DZD,QA1DY;cAAA;cAAA;YAAA;;YA2DdL,IAAI;YA3DU;YAAA,OA4DaX,KAAK,CAACkB,QAAN,CAAe,2BAAf,EAA4CD,IAA5C,CA5Db;;UAAA;YA4DRE,YA5DQ;YA6Dd;YACApB,MAAM,CAACqB,SAAP,CAAiBD,YAAjB;;UA9Dc;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EAAA;IAAA;EAAA;AAAA;AAkEApB,MAAM,CAACsB,SAAP,CAAiB,YAAM;EACrB;EACAnB,SAAS,CAACoB,IAAV;AACD,CAHD"}]}