{"remainingRequest":"E:\\remake-front\\node_modules\\babel-loader\\lib\\index.js!E:\\remake-front\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\remake-front\\src\\permission.js","dependencies":[{"path":"E:\\remake-front\\src\\permission.js","mtime":1656845791850},{"path":"E:\\remake-front\\babel.config.js","mtime":1656845791828},{"path":"E:\\remake-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\remake-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\remake-front\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRTovcmVtYWtlLWZyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRTovcmVtYWtlLWZyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0IHJvdXRlciBmcm9tICcuL3JvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICcuL3N0b3JlJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgTlByb2dyZXNzIGZyb20gJ25wcm9ncmVzcyc7IC8vIHByb2dyZXNzIGJhcgoKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7IC8vIHByb2dyZXNzIGJhciBzdHlsZQoKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOyAvLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKCmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9nZXQtcGFnZS10aXRsZSc7Ck5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsgLy8gTlByb2dyZXNzIENvbmZpZ3VyYXRpb24KCnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbicsICcvYXV0aC1yZWRpcmVjdCddOyAvLyBubyByZWRpcmVjdCB3aGl0ZWxpc3QKCnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgaGFzVG9rZW4sIHJvbGUsIGFjY2Vzc1JvdXRlczsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgLy8gc3RhcnQgcHJvZ3Jlc3MgYmFyCiAgICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOyAvLyBzZXQgcGFnZSB0aXRsZQoKICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBnZXRQYWdlVGl0bGUodG8ubWV0YS50aXRsZSk7IC8vIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGhhcyBsb2dnZWQgaW4KICAgICAgICAgICAgLy8gY29uc3QgaGFzVG9rZW4gPSBnZXRUb2tlbigpCiAgICAgICAgICAgIC8vIGlmIChoYXNUb2tlbikgewogICAgICAgICAgICAvLyAgIGlmICh0by5wYXRoID09PSAnL2xvZ2luJykgewogICAgICAgICAgICAvLyAgICAgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCiAgICAgICAgICAgIC8vICAgICBuZXh0KHsgcGF0aDogJy8nIH0pCiAgICAgICAgICAgIC8vICAgICBOUHJvZ3Jlc3MuZG9uZSgpCiAgICAgICAgICAgIC8vICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGhhcyBvYnRhaW5lZCBoaXMgcGVybWlzc2lvbiByb2xlcyB0aHJvdWdoIGdldEluZm8KICAgICAgICAgICAgLy8gICAgIGNvbnN0IGhhc1JvbGVzID0gc3RvcmUuZ2V0dGVycy5yb2xlcyAmJiBzdG9yZS5nZXR0ZXJzLnJvbGVzLmxlbmd0aCA+IDAKICAgICAgICAgICAgLy8gICAgIGlmIChoYXNSb2xlcykgewogICAgICAgICAgICAvLyAgICAgICBuZXh0KCkKICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vICAgICAgICAgLy8gZ2V0IHVzZXIgaW5mbwogICAgICAgICAgICAvLyAgICAgICAgIC8vIG5vdGU6IHJvbGVzIG11c3QgYmUgYSBvYmplY3QgYXJyYXkhIHN1Y2ggYXM6IFsnYWRtaW4nXSBvciAsWydkZXZlbG9wZXInLCdlZGl0b3InXQogICAgICAgICAgICAvLyAgICAgICAgIGNvbnN0IHsgcm9sZXMgfSA9IGF3YWl0IHN0b3JlLmRpc3BhdGNoKCd1c2VyL2dldEluZm8nKQogICAgICAgICAgICAvLyAgICAgICAgIC8vIGdlbmVyYXRlIGFjY2Vzc2libGUgcm91dGVzIG1hcCBiYXNlZCBvbiByb2xlcwogICAgICAgICAgICAvLyAgICAgICAgIGNvbnN0IGFjY2Vzc1JvdXRlcyA9IGF3YWl0IHN0b3JlLmRpc3BhdGNoKCdwZXJtaXNzaW9uL2dlbmVyYXRlUm91dGVzJywgcm9sZXMpCiAgICAgICAgICAgIC8vICAgICAgICAgLy8gZHluYW1pY2FsbHkgYWRkIGFjY2Vzc2libGUgcm91dGVzCiAgICAgICAgICAgIC8vICAgICAgICAgcm91dGVyLmFkZFJvdXRlcyhhY2Nlc3NSb3V0ZXMpCiAgICAgICAgICAgIC8vICAgICAgICAgLy8gaGFjayBtZXRob2QgdG8gZW5zdXJlIHRoYXQgYWRkUm91dGVzIGlzIGNvbXBsZXRlCiAgICAgICAgICAgIC8vICAgICAgICAgLy8gc2V0IHRoZSByZXBsYWNlOiB0cnVlLCBzbyB0aGUgbmF2aWdhdGlvbiB3aWxsIG5vdCBsZWF2ZSBhIGhpc3RvcnkgcmVjb3JkCiAgICAgICAgICAgIC8vICAgICAgICAgbmV4dCh7IC4uLnRvLCByZXBsYWNlOiB0cnVlIH0pCiAgICAgICAgICAgIC8vICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIC8vICAgICAgICAgLy8gcmVtb3ZlIHRva2VuIGFuZCBnbyB0byBsb2dpbiBwYWdlIHRvIHJlLWxvZ2luCiAgICAgICAgICAgIC8vICAgICAgICAgYXdhaXQgc3RvcmUuZGlzcGF0Y2goJ3VzZXIvcmVzZXRUb2tlbicpCiAgICAgICAgICAgIC8vICAgICAgICAgTWVzc2FnZS5lcnJvcihlcnJvciB8fCAnSGFzIEVycm9yJykKICAgICAgICAgICAgLy8gICAgICAgICBuZXh0KGAvbG9naW4/cmVkaXJlY3Q9JHt0by5wYXRofWApCiAgICAgICAgICAgIC8vICAgICAgICAgTlByb2dyZXNzLmRvbmUoKQogICAgICAgICAgICAvLyAgICAgICB9CiAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgIC8vICAgfQogICAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgICAvLyAgIC8qIGhhcyBubyB0b2tlbiovCiAgICAgICAgICAgIC8vICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAvLyAgICAgLy8gaW4gdGhlIGZyZWUgbG9naW4gd2hpdGVsaXN0LCBnbyBkaXJlY3RseQogICAgICAgICAgICAvLyAgICAgbmV4dCgpCiAgICAgICAgICAgIC8vICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gICAgIC8vIG90aGVyIHBhZ2VzIHRoYXQgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgYXJlIHJlZGlyZWN0ZWQgdG8gdGhlIGxvZ2luIHBhZ2UuCiAgICAgICAgICAgIC8vICAgICBuZXh0KGAvbG9naW4/cmVkaXJlY3Q9JHt0by5wYXRofWApCiAgICAgICAgICAgIC8vICAgICBOUHJvZ3Jlc3MuZG9uZSgpCiAgICAgICAgICAgIC8vICAgfQogICAgICAgICAgICAvLyB9CgogICAgICAgICAgICBoYXNUb2tlbiA9ICdhZG1pbi10b2tlbic7CiAgICAgICAgICAgIHJvbGUgPSAnYWRtaW4nOwoKICAgICAgICAgICAgaWYgKCFoYXNUb2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdwZXJtaXNzaW9uL2dlbmVyYXRlUm91dGVzJywgcm9sZSk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAvLyBkeW5hbWljYWxseSBhZGQgYWNjZXNzaWJsZSByb3V0ZXMKICAgICAgICAgICAgcm91dGVyLmFkZFJvdXRlcyhhY2Nlc3NSb3V0ZXMpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICAvLyBmaW5pc2ggcHJvZ3Jlc3MgYmFyCiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","from","next","start","document","title","meta","hasToken","role","dispatch","accessRoutes","addRoutes","afterEach","done"],"sources":["E:/remake-front/src/permission.js"],"sourcesContent":["import router from './router'\r\nimport store from './store'\r\nimport { Message } from 'element-ui'\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nimport { getToken } from '@/utils/auth' // get token from cookie\r\nimport getPageTitle from '@/utils/get-page-title'\r\n\r\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\r\n\r\nconst whiteList = ['/login', '/auth-redirect'] // no redirect whitelist\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  // start progress bar\r\n  NProgress.start()\r\n\r\n  // set page title\r\n  document.title = getPageTitle(to.meta.title)\r\n\r\n  // determine whether the user has logged in\r\n  // const hasToken = getToken()\r\n\r\n  // if (hasToken) {\r\n  //   if (to.path === '/login') {\r\n  //     // if is logged in, redirect to the home page\r\n  //     next({ path: '/' })\r\n  //     NProgress.done()\r\n  //   } else {\r\n  //     // determine whether the user has obtained his permission roles through getInfo\r\n  //     const hasRoles = store.getters.roles && store.getters.roles.length > 0\r\n  //     if (hasRoles) {\r\n  //       next()\r\n  //     } else {\r\n  //       try {\r\n  //         // get user info\r\n  //         // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']\r\n  //         const { roles } = await store.dispatch('user/getInfo')\r\n\r\n  //         // generate accessible routes map based on roles\r\n  //         const accessRoutes = await store.dispatch('permission/generateRoutes', roles)\r\n\r\n  //         // dynamically add accessible routes\r\n  //         router.addRoutes(accessRoutes)\r\n\r\n  //         // hack method to ensure that addRoutes is complete\r\n  //         // set the replace: true, so the navigation will not leave a history record\r\n  //         next({ ...to, replace: true })\r\n  //       } catch (error) {\r\n  //         // remove token and go to login page to re-login\r\n  //         await store.dispatch('user/resetToken')\r\n  //         Message.error(error || 'Has Error')\r\n  //         next(`/login?redirect=${to.path}`)\r\n  //         NProgress.done()\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // } else {\r\n  //   /* has no token*/\r\n\r\n  //   if (whiteList.indexOf(to.path) !== -1) {\r\n  //     // in the free login whitelist, go directly\r\n  //     next()\r\n  //   } else {\r\n  //     // other pages that do not have permission to access are redirected to the login page.\r\n  //     next(`/login?redirect=${to.path}`)\r\n  //     NProgress.done()\r\n  //   }\r\n  // }\r\n  const hasToken = 'admin-token'\r\n  const role = 'admin'\r\n  if (hasToken) {\r\n    next()\r\n    const accessRoutes = await store.dispatch('permission/generateRoutes', role)\r\n    // dynamically add accessible routes\r\n    router.addRoutes(accessRoutes)\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  // finish progress bar\r\n  NProgress.done()\r\n})\r\n"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB,C,CAAkC;;AAClC,OAAO,yBAAP,C,CAAiC;;AACjC,SAASC,QAAT,QAAyB,cAAzB,C,CAAwC;;AACxC,OAAOC,YAAP,MAAyB,wBAAzB;AAEAF,SAAS,CAACG,SAAV,CAAoB;EAAEC,WAAW,EAAE;AAAf,CAApB,E,CAA4C;;AAE5C,IAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,gBAAX,CAAlB,C,CAA+C;;AAE/CR,MAAM,CAACS,UAAP;EAAA,sEAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;IAAA;IAAA;MAAA;QAAA;UAAA;YAChB;YACAT,SAAS,CAACU,KAAV,GAFgB,CAIhB;;YACAC,QAAQ,CAACC,KAAT,GAAiBV,YAAY,CAACK,EAAE,CAACM,IAAH,CAAQD,KAAT,CAA7B,CALgB,CAOhB;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YAEA;YACA;YAEA;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YAEA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;;YACME,QAxDU,GAwDC,aAxDD;YAyDVC,IAzDU,GAyDH,OAzDG;;YAAA,KA0DZD,QA1DY;cAAA;cAAA;YAAA;;YA2DdL,IAAI;YA3DU;YAAA,OA4DaX,KAAK,CAACkB,QAAN,CAAe,2BAAf,EAA4CD,IAA5C,CA5Db;;UAAA;YA4DRE,YA5DQ;YA6Dd;YACApB,MAAM,CAACqB,SAAP,CAAiBD,YAAjB;;UA9Dc;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EAAA;IAAA;EAAA;AAAA;AAkEApB,MAAM,CAACsB,SAAP,CAAiB,YAAM;EACrB;EACAnB,SAAS,CAACoB,IAAV;AACD,CAHD"}]}